<!DOCTYPE html>
<html>
<head>
    <title>Math Quiz - Score</title>
    <script src="{{ url_for('static', filename='skycons.js') }}"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 20px;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-image: url('https://wallpaperaccess.com/full/237627.jpg');
            background-size: cover;
            background-position: center;
        }
        .container {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            width: 70%;
            max-width: 800px;
        }
        h1 {
            font-size: 32px;
            margin-bottom: 20px;
        }
        p.score {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 20px;
        }
        button {
            font-size: 18px;
            padding: 10px 20px;
            margin: 10px;
        }
        @keyframes grow {
            0% {
                transform: scale(1);
            }
            100% {
                transform: scale(2);
            }
        }
        .message {
            animation: grow 2s ease-in-out infinite alternate;
        }
        #rain {
            width: 700px;
            height: 300px;
            position: left;
            margin-top: -225px;
        }
        .clouds {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100px;
            background-image: url('https://i.imgur.com/3jubbVF.png');
            background-repeat: repeat-x;
            animation: move-clouds 10s linear infinite;
        }

        @keyframes move-clouds {
            0% {
                background-position: 0 0;
            }
            100% {
                background-position: -500px 0;
            }
        }

        .raindrop {
            position: absolute;
            width: 2px;
            height: 10px;
            background-color: blue;
            animation: fall 3s linear infinite;
            opacity: 0;
        }

        @keyframes fall {
            0% {
                opacity: 0;
                transform: translateY(-100px);
            }
            1% {
                opacity: 1;
            }
            99% {
                opacity: 1;
            }
            100% {
                opacity: 0;
                transform: translateY(100%);
            }
        }
    </style>
    <script>
<!--        function initRain(score) {-->
<!--            if (score < 7) {-->
<!--                var canvas = document.getElementById('rain');-->
<!--                var skycons = new Skycons({"color": "blue"});-->
<!--                skycons.add(canvas, "RAIN");-->
<!--                skycons.play();-->
<!--            }-->
<!--        }-->

<!--        function toggleExplanation(button) {-->
<!--            const explanation = button.nextElementSibling;-->
<!--            if (explanation.style.display === "none") {-->
<!--                explanation.style.display = "block";-->
<!--                button.innerText = "Hide Explanation";-->
<!--            } else {-->
<!--                explanation.style.display = "none";-->
<!--                button.innerText = "Show Explanation";-->
<!--            }-->
<!--        }-->

        function createRaindrops() {
            const rainContainer = document.querySelector(".rain-container");
            const numRaindrops = 100;
            for (let i = 0; i < numRaindrops; i++) {
                const raindrop = document.createElement("div");
                raindrop.classList.add("raindrop");
                raindrop.style.left = Math.random() * 100 + "vw";
                raindrop.style.animationDelay = Math.random() * 3 + "s";
                raindrop.style.animationDuration = (Math.random() * 2 + 1) + "s";
                rainContainer.appendChild(raindrop);
            }
        }
        function showRain() {
            let clouds = document.querySelector('.clouds');
            let rainContainer = document.querySelector('.rain-container');
            clouds.style.display = 'block';
            rainContainer.style.display = 'block';
}

       function initRaindrops(score) {
            if (score < 3) {
                createRaindrops();
                showRain();
                setTimeout(hideRaindrops, 3000);
    }
}
    </script>
</head>

<body onload="initRaindrops({{ score }})">
    <div class="container">
        <div class="clouds"></div>
        <div class="rain-container"></div>
<!--        <canvas id="rain"></canvas>-->
        <h1>Quiz Score</h1>
        {% if score is not none %}
            <p class="score">Your score is {{ score }}/10.</p>
            {% if score < 7 %}
                <p class="message">You Suck</p>
            {% else %}
                <p class="message">You Passed</p>
            {% endif %}
        {% endif %}

       {% if wrong_questions %}
            <h2>Questions you got wrong:</h2>
            <ol>
                {% for question in wrong_questions %}
                {% if question|length == 4 %}
                {% set a, b, c, correct = question[:4] %}

                    <li>
                        <!-- Easy question explanation -->
                        <p>{{ a }} + {{ b }}x = {{ c }}</p>
                        <p>Correct answer: x = {{ correct }}</p>
                        <button class="explain-btn" onclick="toggleExplanation(this)">Show Explanation</button>
                        <div class="explanation" style="display: none;">
                            <p>Explanation: To solve this equation, isolate the x variable by subtracting a from both sides and then dividing by b.</p>
                            <p>Step 1: Subtract {{ a }} from both sides: {{ b }}x = {{ c - a }}</p>
                            <p>Step 2: Divide by {{ b }}: x = ({{ c - a }}) / {{ b }}</p>
                            <p>Result: x = {{ correct }}</p>
                        </div>
                    </li>
                {% elif question|length == 6 %}
                {% set a, b, c, d, eq_value, correct = question[:6] %}

<!--                Here I added the explanation for hard questions. I think the problem is here?-->

                    <li>
                        <!-- Hard question explanation -->
                        <p>{{ a }}(x + {{ b }}) + {{ c }}(x - {{ d }}) = {{ eq_value }}</p>

                        <p>Correct answer: x = {{ correct }}</p>
                        <button class="explain-btn" onclick="toggleExplanation(this)">Show Explanation</button>
                        <div class="explanation" style="display: none;">
                            <p>Explanation: To solve this equation, use the quadratic formula: x = (-B ± sqrt(B^2 - 4AC)) / 2A</p>
                            <p>Step 1: Identify the coefficients: A = {{ c }}, B = {{ b }}, C = {{ a - d }}</p>
                            <p>Step 2: Calculate the discriminant: Δ = B^2 - 4AC</p>
                            <p>Step 3: Find the two possible values for x using the quadratic formula</p>
                            <p>Result: x = {{ correct }}</p>
                        </div>
                    </li>
                {% endif %}
            {% endfor %}
            </ol>
        {% endif %}
        <a href="{{ url_for('home') }}"><button type="button">Back to Home</button></a>
    </div>
</body>

</html>

</html>